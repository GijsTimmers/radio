#!/usr/bin/env python2
# -*- coding: utf-8 -*-
# PYTHON_ARGCOMPLETE_OK

## Dependencies:    mplayer, argparse, argcomplete, pyYAML
## Author:          Gijs Timmers: https://github.com/GijsTimmers

## Licence:         CC-BY-SA-4.0
##                  http://creativecommons.org/licenses/by-sa/4.0/

## This work is licensed under the Creative Commons
## Attribution-ShareAlike 4.0 International License. To  view a copy of
## this license, visit http://creativecommons.org/licenses/by-sa/4.0/ or
## send a letter to Creative Commons, PO Box 1866, Mountain View,
## CA 94042, USA.

import time
import threading
import subprocess
from colorama import Fore, Style

###############################################################################
def ok():
    print Style.BRIGHT + Fore.GREEN + "OK" + Fore.RESET + Style.RESET_ALL
def error():
    print Style.BRIGHT + Fore.RED + "ERROR" + Fore.RESET + Style.RESET_ALL

###############################################################################
print "Imports testen...",
try:
    from yamlradio import yamlradio
    from yamlradio import fabriek
    ok()
except Exception as e:
    error()
    print e.message, e.args
    exit(1)
###############################################################################
print "Radio() instantiëren...",
try:
    rd = yamlradio.Radio()
    ok()
except Exception as e:
    error()
    print e.message, e.args
    exit(1)
###############################################################################
print "Fabriek() instantiëren...",
try:
    fa = fabriek.Fabriek()
    ok()
except Exception as e:
    error()
    print e.message, e.args
    exit(1)
###############################################################################
print "Variabelen testen...",
try:
    pa = yamlradio.Parser()
    ok()
except Exception as e:
    error()
    print e.message, e.args
    exit(1)
###############################################################################
print "Afspeelmechanisme testen..."
afkortingenlijst = [combinatie["afk"] for combinatie \
in pa.zenderdict]

try:
    for afk in afkortingenlijst:
        p = subprocess.Popen(["./yamlradio/yamlradio.py", afk])
        time.sleep(3)
        p.kill()
        ok()
except Exception as e:
    error()
    print e.message, e.args
    exit(1)

###############################################################################